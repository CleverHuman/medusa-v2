<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.medusa.mall.mapper.VendorMapper">
    
    <resultMap type="com.medusa.mall.domain.vendor.Vendor" id="VendorResult">
        <id     property="id"                   column="id"                  />
        <result property="vendorCode"           column="vendor_code"         />
        <result property="vendorName"           column="vendor_name"         />
        <result property="description"          column="description"         />
        <result property="logoUrl"              column="logo_url"            />
        <result property="bannerUrl"            column="banner_url"          />
        <result property="contactTelegram"      column="contact_telegram"    />
        <result property="contactSignal"        column="contact_signal"      />
        <result property="contactJabber"        column="contact_jabber"      />
        <result property="contactEmail"         column="contact_email"       />
        <result property="contactThreema"      column="contact_threema"      />
        <result property="secondaryTelegram"   column="secondary_telegram"   />
        <result property="secondarySignal"    column="secondary_signal"     />
        <result property="secondaryJabber"      column="secondary_jabber"     />
        <result property="secondaryEmail"      column="secondary_email"      />
        <result property="secondaryThreema"    column="secondary_threema"     />
        <result property="pgpPublicKeyUrl"      column="pgp_public_key_url"  />
        <result property="btcWallet"            column="btc_wallet"          />
        <result property="xmrWallet"            column="xmr_wallet"          />
        <result property="usdtWallet"           column="usdt_wallet"         />
        <result property="productCategories"    column="product_categories"  />
        <result property="location"             column="location"            />
        <result property="rating"               column="rating"              />
        <result property="totalSales"           column="total_sales"         />
        <result property="totalOrders"          column="total_orders"        />
        <result property="shopId"               column="shop_id"             />
        <result property="status"               column="status"              />
        <result property="isFeatured"           column="is_featured"         />
        <result property="sortOrder"            column="sort_order"          />
        <result property="applicationId"        column="application_id"      />
        <result property="approvedTime"         column="approved_time"       />
        <result property="approvedBy"           column="approved_by"         />
        <result property="bond"                 column="bond"                />
        <result property="level"                column="level"               />
        <result property="salesPoints"          column="sales_points"        />
        <result property="withdrawableBalance"  column="withdrawable_balance" />
        <result property="pendingBalance"       column="pending_balance"     />
        <result property="totalWithdrawn"       column="total_withdrawn"     />
        <result property="createTime"           column="create_time"         />
        <result property="updateTime"           column="update_time"         />
        <result property="createBy"             column="create_by"           />
        <result property="updateBy"             column="update_by"           />
        <result property="remark"               column="remark"              />
    </resultMap>

    <sql id="selectVendorVo">
        select id, vendor_code, vendor_name, description, logo_url, banner_url,
               contact_telegram, contact_signal, contact_jabber, contact_email, contact_threema,
               secondary_telegram, secondary_signal, secondary_jabber, secondary_email, secondary_threema,
               pgp_public_key_url, btc_wallet, xmr_wallet, usdt_wallet,
               product_categories, location, rating, total_sales, total_orders,
               shop_id, status, is_featured, sort_order, application_id,
               approved_time, approved_by, bond, level, sales_points,
               withdrawable_balance, pending_balance, total_withdrawn,
               create_time, update_time, create_by, update_by, remark
        from mall_vendor
    </sql>

    <select id="selectVendorList" parameterType="com.medusa.mall.domain.vendor.Vendor" resultMap="VendorResult">
        <include refid="selectVendorVo"/>
        <where>
            del_flag = '0'
            <if test="vendorCode != null and vendorCode != ''">
                AND vendor_code like concat('%', #{vendorCode}, '%')
            </if>
            <if test="vendorName != null and vendorName != ''">
                AND vendor_name like concat('%', #{vendorName}, '%')
            </if>
            <if test="status != null">
                AND status = #{status}
            </if>
            <if test="location != null and location != ''">
                AND location = #{location}
            </if>
            <if test="isFeatured != null">
                AND is_featured = #{isFeatured}
            </if>
        </where>
        order by sort_order asc, create_time desc
    </select>

    <select id="selectVendorById" parameterType="Long" resultMap="VendorResult">
        <include refid="selectVendorVo"/>
        where id = #{id} and del_flag = '0'
    </select>

    <select id="selectByVendorCode" parameterType="String" resultMap="VendorResult">
        <include refid="selectVendorVo"/>
        where vendor_code = #{vendorCode} and del_flag = '0'
    </select>

    <insert id="insertVendor" parameterType="com.medusa.mall.domain.vendor.Vendor" useGeneratedKeys="true" keyProperty="id">
        insert into mall_vendor
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="vendorCode != null and vendorCode != ''">vendor_code,</if>
            <if test="vendorName != null and vendorName != ''">vendor_name,</if>
            <if test="description != null">description,</if>
            <if test="logoUrl != null">logo_url,</if>
            <if test="bannerUrl != null">banner_url,</if>
            <if test="contactTelegram != null">contact_telegram,</if>
            <if test="contactSignal != null">contact_signal,</if>
            <if test="contactJabber != null">contact_jabber,</if>
            <if test="contactEmail != null">contact_email,</if>
            <if test="contactThreema != null">contact_threema,</if>
            <if test="secondaryTelegram != null">secondary_telegram,</if>
            <if test="secondarySignal != null">secondary_signal,</if>
            <if test="secondaryJabber != null">secondary_jabber,</if>
            <if test="secondaryEmail != null">secondary_email,</if>
            <if test="secondaryThreema != null">secondary_threema,</if>
            <if test="pgpPublicKeyUrl != null">pgp_public_key_url,</if>
            <if test="btcWallet != null">btc_wallet,</if>
            <if test="xmrWallet != null">xmr_wallet,</if>
            <if test="usdtWallet != null">usdt_wallet,</if>
            <if test="productCategories != null">product_categories,</if>
            <if test="location != null">location,</if>
            <if test="rating != null">rating,</if>
            <if test="totalSales != null">total_sales,</if>
            <if test="totalOrders != null">total_orders,</if>
            <if test="shopId != null">shop_id,</if>
            <if test="status != null">status,</if>
            <if test="isFeatured != null">is_featured,</if>
            <if test="sortOrder != null">sort_order,</if>
            <if test="applicationId != null">application_id,</if>
            <if test="approvedTime != null">approved_time,</if>
            <if test="approvedBy != null">approved_by,</if>
            <if test="bond != null">bond,</if>
            <if test="level != null">level,</if>
            <if test="salesPoints != null">sales_points,</if>
            <if test="withdrawableBalance != null">withdrawable_balance,</if>
            <if test="pendingBalance != null">pending_balance,</if>
            <if test="totalWithdrawn != null">total_withdrawn,</if>
            <if test="createBy != null">create_by,</if>
            <if test="remark != null">remark,</if>
            create_time
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="vendorCode != null and vendorCode != ''">#{vendorCode},</if>
            <if test="vendorName != null and vendorName != ''">#{vendorName},</if>
            <if test="description != null">#{description},</if>
            <if test="logoUrl != null">#{logoUrl},</if>
            <if test="bannerUrl != null">#{bannerUrl},</if>
            <if test="contactTelegram != null">#{contactTelegram},</if>
            <if test="contactSignal != null">#{contactSignal},</if>
            <if test="contactJabber != null">#{contactJabber},</if>
            <if test="contactEmail != null">#{contactEmail},</if>
            <if test="contactThreema != null">#{contactThreema},</if>
            <if test="secondaryTelegram != null">#{secondaryTelegram},</if>
            <if test="secondarySignal != null">#{secondarySignal},</if>
            <if test="secondaryJabber != null">#{secondaryJabber},</if>
            <if test="secondaryEmail != null">#{secondaryEmail},</if>
            <if test="secondaryThreema != null">#{secondaryThreema},</if>
            <if test="pgpPublicKeyUrl != null">#{pgpPublicKeyUrl},</if>
            <if test="btcWallet != null">#{btcWallet},</if>
            <if test="xmrWallet != null">#{xmrWallet},</if>
            <if test="usdtWallet != null">#{usdtWallet},</if>
            <if test="productCategories != null">#{productCategories},</if>
            <if test="location != null">#{location},</if>
            <if test="rating != null">#{rating},</if>
            <if test="totalSales != null">#{totalSales},</if>
            <if test="totalOrders != null">#{totalOrders},</if>
            <if test="shopId != null">#{shopId},</if>
            <if test="status != null">#{status},</if>
            <if test="isFeatured != null">#{isFeatured},</if>
            <if test="sortOrder != null">#{sortOrder},</if>
            <if test="applicationId != null">#{applicationId},</if>
            <if test="approvedTime != null">#{approvedTime},</if>
            <if test="approvedBy != null">#{approvedBy},</if>
            <if test="bond != null">#{bond},</if>
            <if test="level != null">#{level},</if>
            <if test="salesPoints != null">#{salesPoints},</if>
            <if test="withdrawableBalance != null">#{withdrawableBalance},</if>
            <if test="pendingBalance != null">#{pendingBalance},</if>
            <if test="totalWithdrawn != null">#{totalWithdrawn},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="remark != null">#{remark},</if>
            sysdate()
        </trim>
    </insert>

    <update id="updateVendor" parameterType="com.medusa.mall.domain.vendor.Vendor">
        update mall_vendor
        <trim prefix="SET" suffixOverrides=",">
            <if test="vendorName != null and vendorName != ''">vendor_name = #{vendorName},</if>
            <if test="description != null">description = #{description},</if>
            <if test="logoUrl != null">logo_url = #{logoUrl},</if>
            <if test="bannerUrl != null">banner_url = #{bannerUrl},</if>
            <if test="contactTelegram != null">contact_telegram = #{contactTelegram},</if>
            <if test="contactSignal != null">contact_signal = #{contactSignal},</if>
            <if test="contactJabber != null">contact_jabber = #{contactJabber},</if>
            <if test="contactEmail != null">contact_email = #{contactEmail},</if>
            <if test="contactThreema != null">contact_threema = #{contactThreema},</if>
            <if test="secondaryTelegram != null">secondary_telegram = #{secondaryTelegram},</if>
            <if test="secondarySignal != null">secondary_signal = #{secondarySignal},</if>
            <if test="secondaryJabber != null">secondary_jabber = #{secondaryJabber},</if>
            <if test="secondaryEmail != null">secondary_email = #{secondaryEmail},</if>
            <if test="secondaryThreema != null">secondary_threema = #{secondaryThreema},</if>
            <if test="pgpPublicKeyUrl != null">pgp_public_key_url = #{pgpPublicKeyUrl},</if>
            <if test="btcWallet != null">btc_wallet = #{btcWallet},</if>
            <if test="xmrWallet != null">xmr_wallet = #{xmrWallet},</if>
            <if test="usdtWallet != null">usdt_wallet = #{usdtWallet},</if>
            <if test="productCategories != null">product_categories = #{productCategories},</if>
            <if test="location != null">location = #{location},</if>
            <if test="rating != null">rating = #{rating},</if>
            <if test="totalSales != null">total_sales = #{totalSales},</if>
            <if test="totalOrders != null">total_orders = #{totalOrders},</if>
            <if test="shopId != null">shop_id = #{shopId},</if>
            <if test="status != null">status = #{status},</if>
            <if test="isFeatured != null">is_featured = #{isFeatured},</if>
            <if test="sortOrder != null">sort_order = #{sortOrder},</if>
            <if test="bond != null">bond = #{bond},</if>
            <if test="level != null">level = #{level},</if>
            <if test="salesPoints != null">sales_points = #{salesPoints},</if>
            <if test="withdrawableBalance != null">withdrawable_balance = #{withdrawableBalance},</if>
            <if test="pendingBalance != null">pending_balance = #{pendingBalance},</if>
            <if test="totalWithdrawn != null">total_withdrawn = #{totalWithdrawn},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="remark != null">remark = #{remark},</if>
            update_time = sysdate()
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteVendorById" parameterType="Long">
        update mall_vendor set del_flag = '2' where id = #{id}
    </delete>

    <delete id="deleteVendorByIds" parameterType="Long">
        update mall_vendor set del_flag = '2' where id in
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <select id="selectByApplicationId" parameterType="Long" resultMap="VendorResult">
        <include refid="selectVendorVo"/>
        where application_id = #{applicationId} and del_flag = '0'
    </select>
</mapper>

