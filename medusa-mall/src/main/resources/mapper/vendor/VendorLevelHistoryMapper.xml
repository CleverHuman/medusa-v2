<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.medusa.mall.mapper.VendorLevelHistoryMapper">
    
    <resultMap type="com.medusa.mall.domain.vendor.VendorLevelHistory" id="VendorLevelHistoryResult">
        <id     property="id"                   column="id"                  />
        <result property="vendorId"             column="vendor_id"           />
        <result property="oldLevel"             column="old_level"           />
        <result property="newLevel"             column="new_level"           />
        <result property="oldPoints"            column="old_points"          />
        <result property="newPoints"            column="new_points"          />
        <result property="triggerOrderId"       column="trigger_order_id"    />
        <result property="triggerAmount"        column="trigger_amount"      />
        <result property="createTime"           column="create_time"         />
    </resultMap>

    <sql id="selectVendorLevelHistoryVo">
        select id, vendor_id, old_level, new_level, old_points, new_points,
               trigger_order_id, trigger_amount, create_time
        from mall_vendor_level_history
    </sql>

    <insert id="insertVendorLevelHistory" parameterType="com.medusa.mall.domain.vendor.VendorLevelHistory" useGeneratedKeys="true" keyProperty="id">
        insert into mall_vendor_level_history
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="vendorId != null">vendor_id,</if>
            <if test="oldLevel != null">old_level,</if>
            <if test="newLevel != null">new_level,</if>
            <if test="oldPoints != null">old_points,</if>
            <if test="newPoints != null">new_points,</if>
            <if test="triggerOrderId != null">trigger_order_id,</if>
            <if test="triggerAmount != null">trigger_amount,</if>
            create_time
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="vendorId != null">#{vendorId},</if>
            <if test="oldLevel != null">#{oldLevel},</if>
            <if test="newLevel != null">#{newLevel},</if>
            <if test="oldPoints != null">#{oldPoints},</if>
            <if test="newPoints != null">#{newPoints},</if>
            <if test="triggerOrderId != null">#{triggerOrderId},</if>
            <if test="triggerAmount != null">#{triggerAmount},</if>
            sysdate()
        </trim>
    </insert>

    <select id="selectVendorLevelHistoryByVendorId" parameterType="Long" resultMap="VendorLevelHistoryResult">
        <include refid="selectVendorLevelHistoryVo"/>
        where vendor_id = #{vendorId}
        order by create_time desc
    </select>

</mapper>

